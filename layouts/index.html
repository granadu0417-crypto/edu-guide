{{ define "title" }}{{ .Site.Title }} | 초중고 학습 정보 플랫폼{{ end }}

{{ define "main" }}
<div class="home-hero">
    <div class="hero-bg-slider">
        <div class="hero-bg-slide active" style="background-image: url('/images/infographic-korean.webp')"></div>
        <div class="hero-bg-slide" style="background-image: url('/images/infographic-english.webp')"></div>
        <div class="hero-bg-slide" style="background-image: url('/images/infographic-study-comparison.webp')"></div>
        <div class="hero-bg-slide" style="background-image: url('/images/infographic-curriculum.webp')"></div>
    </div>
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1 class="hero-title">📚 과외를부탁해</h1>
        <p class="hero-subtitle">초등학생부터 고등학생까지, 학습에 필요한 모든 정보</p>
    </div>
</div>

<script>
// 히어로 배경 슬라이더
(function() {
    const slides = document.querySelectorAll('.hero-bg-slide');
    let currentSlide = 0;

    function nextSlide() {
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide].classList.add('active');
    }

    // 5초마다 슬라이드 변경
    setInterval(nextSlide, 5000);
})();

// 카테고리 슬라이더
(function() {
    const track = document.querySelector('.category-track');
    const prevBtn = document.querySelector('.slider-btn.prev');
    const nextBtn = document.querySelector('.slider-btn.next');
    const indicators = document.querySelectorAll('.indicator');
    const cards = document.querySelectorAll('.category-card');

    let currentIndex = 0;
    const totalSlides = cards.length;

    // 반응형: 화면 크기에 따라 보이는 슬라이드 수
    function getSlidesPerView() {
        if (window.innerWidth <= 480) return 2;
        if (window.innerWidth <= 768) return 3;
        return 4;
    }

    function updateSlider() {
        const slidesPerView = getSlidesPerView();
        const cardWidth = cards[0].offsetWidth;
        const gap = 20; // CSS gap과 동일
        const offset = -(currentIndex * (cardWidth + gap));

        track.style.transform = `translateX(${offset}px)`;

        // 인디케이터 업데이트
        indicators.forEach((indicator, index) => {
            indicator.classList.toggle('active', index === currentIndex);
        });

        // 버튼 활성화/비활성화
        if (currentIndex === 0) {
            prevBtn.classList.add('disabled');
            prevBtn.style.pointerEvents = 'none';
        } else {
            prevBtn.classList.remove('disabled');
            prevBtn.style.pointerEvents = 'auto';
        }

        const maxIndex = totalSlides - slidesPerView;
        if (currentIndex >= maxIndex) {
            nextBtn.classList.add('disabled');
            nextBtn.style.pointerEvents = 'none';
        } else {
            nextBtn.classList.remove('disabled');
            nextBtn.style.pointerEvents = 'auto';
        }
    }

    function goToSlide(index) {
        const slidesPerView = getSlidesPerView();
        const maxIndex = totalSlides - slidesPerView;
        currentIndex = Math.max(0, Math.min(index, maxIndex));
        updateSlider();
    }

    // 이벤트 리스너
    prevBtn.addEventListener('click', () => goToSlide(currentIndex - 1));
    nextBtn.addEventListener('click', () => goToSlide(currentIndex + 1));

    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => goToSlide(index));
    });

    // 반응형 대응
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            goToSlide(currentIndex);
        }, 100);
    });

    // 초기화
    updateSlider();
})();
</script>

<section class="category-section">
    <h2 class="section-title">📖 카테고리별 글 보기</h2>
    <div class="category-slider-wrapper">
        <button class="slider-btn prev" aria-label="이전">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </button>
        <div class="category-slider">
            <div class="category-track">
                <a href="/elementary/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-english.webp')"></div>
                    <div class="category-content">
                        <h3>🎒 초등학생</h3>
                        <p>초등 학습 정보</p>
                    </div>
                </a>
                <a href="/middle/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-korean.webp')"></div>
                    <div class="category-content">
                        <h3>📝 중학생</h3>
                        <p>중학 내신·학습</p>
                    </div>
                </a>
                <a href="/high/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-study-comparison.webp')"></div>
                    <div class="category-content">
                        <h3>🎓 고등학생</h3>
                        <p>고등 수능·입시</p>
                    </div>
                </a>
                <a href="/subjects/korean/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-korean.webp')"></div>
                    <div class="category-content">
                        <h3>📚 국어</h3>
                        <p>국어 공부법</p>
                    </div>
                </a>
                <a href="/subjects/english/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-english.webp')"></div>
                    <div class="category-content">
                        <h3>🔤 영어</h3>
                        <p>영어 공부법</p>
                    </div>
                </a>
                <a href="/subjects/math/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-study-comparison.webp')"></div>
                    <div class="category-content">
                        <h3>🔢 수학</h3>
                        <p>수학 공부법</p>
                    </div>
                </a>
                <a href="/subjects/science/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-curriculum.webp')"></div>
                    <div class="category-content">
                        <h3>🔬 과학</h3>
                        <p>과학 공부법</p>
                    </div>
                </a>
                <a href="/subjects/social/" class="category-card">
                    <div class="category-image" style="background-image: url('/images/infographic-korean.webp')"></div>
                    <div class="category-content">
                        <h3>🌍 사회</h3>
                        <p>사회 공부법</p>
                    </div>
                </a>
            </div>
        </div>
        <button class="slider-btn next" aria-label="다음">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        </button>
    </div>
    <div class="slider-indicators">
        <span class="indicator active" data-slide="0"></span>
        <span class="indicator" data-slide="1"></span>
        <span class="indicator" data-slide="2"></span>
        <span class="indicator" data-slide="3"></span>
        <span class="indicator" data-slide="4"></span>
        <span class="indicator" data-slide="5"></span>
        <span class="indicator" data-slide="6"></span>
        <span class="indicator" data-slide="7"></span>
    </div>
</section>

<section class="recent-posts">
    <h2 class="section-title">✨ 최신 글</h2>
    <div class="post-list">
        {{ range first 10 (where .Site.RegularPages "Type" "in" (slice "elementary" "middle" "high" "local" "exam" "subjects" "tutoring")) }}
        <article class="post-card">
            <div class="post-categories">
                {{ range .Params.categories }}
                <span class="post-category">{{ . }}</span>
                {{ end }}
            </div>
            <h3 class="post-card-title">
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            </h3>
            <p class="post-card-excerpt">{{ .Description | truncate 120 }}</p>
            <div class="post-card-meta">
                <span class="post-date">{{ .Date.Format "2006.01.02" }}</span>
            </div>
        </article>
        {{ end }}
    </div>
</section>

<section class="ad-banner-home">
    <h3>🎯 맞춤 학습 컨설팅</h3>
    <p>전문가와 함께하는 1:1 학습 설계</p>
    <a href="https://pf.kakao.com/_Cixlaxl/chat" target="_blank" rel="noopener noreferrer">
        <button class="banner-button">카카오톡 상담하기</button>
    </a>
</section>

<style>
.home-hero {
    position: relative;
    text-align: center;
    padding: 100px 20px;
    color: white;
    border-radius: 16px;
    margin-bottom: 60px;
    overflow: hidden;
    background-color: #667eea;
}

/* 배경 슬라이더 */
.hero-bg-slider {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 0;
}

.hero-bg-slide {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 1s ease-in-out;
}

.hero-bg-slide.active {
    opacity: 1;
}

.hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0) 0%, rgba(118, 75, 162, 0) 100%);
    z-index: 1;
}

.hero-content {
    position: relative;
    z-index: 2;
}

.hero-title {
    font-size: var(--font-2xl);
    font-weight: 800;
    margin-bottom: 16px;
}

.hero-subtitle {
    font-size: var(--font-lg);
    font-weight: 500;
    opacity: 0.95;
}

.category-section, .recent-posts {
    margin-bottom: 80px;
}

.section-title {
    font-size: var(--font-xl);
    font-weight: 700;
    margin-bottom: 32px;
    text-align: center;
    color: var(--text-primary);
}

/* 카테고리 슬라이더 */
.category-slider-wrapper {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 60px;
}

.category-slider {
    overflow: hidden;
    border-radius: 16px;
}

.category-track {
    display: flex;
    gap: 20px;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.category-card {
    display: flex;
    flex-direction: column;
    background: white;
    border: 2px solid var(--border-light);
    border-radius: 12px;
    text-decoration: none;
    transition: all 0.3s ease;
    overflow: hidden;
    flex-shrink: 0;
    width: calc((100% - 60px) / 4);
}

.category-card:hover {
    transform: translateY(-4px);
    border-color: var(--primary-color);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
}

.category-image {
    width: 100%;
    height: 160px;
    background-size: cover;
    background-position: center;
    transition: transform 0.3s ease;
}

.category-card:hover .category-image {
    transform: scale(1.05);
}

.category-content {
    padding: 24px;
    text-align: center;
}

.category-content h3 {
    font-size: var(--font-lg);
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 8px;
}

.category-content p {
    font-size: var(--font-sm);
    color: var(--text-secondary);
    margin: 0;
}

/* 슬라이더 버튼 */
.slider-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: white;
    border: 2px solid var(--border-light);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10;
    color: var(--primary-color);
}

.slider-btn:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
}

.slider-btn.prev {
    left: 0;
}

.slider-btn.next {
    right: 0;
}

.slider-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.slider-btn.disabled:hover {
    background: white;
    color: var(--primary-color);
    border-color: var(--border-light);
    box-shadow: none;
}

/* 인디케이터 */
.slider-indicators {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 24px;
}

.indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--border-light);
    cursor: pointer;
    transition: all 0.3s ease;
}

.indicator:hover {
    background: var(--primary-color);
    opacity: 0.7;
}

.indicator.active {
    width: 24px;
    border-radius: 4px;
    background: var(--primary-color);
}

.post-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 32px;
}

.post-card {
    background: white;
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.3s ease;
}

.post-card:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.post-categories {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
}

.post-category {
    display: inline-block;
    padding: 4px 12px;
    background: var(--bg-secondary);
    color: var(--primary-color);
    font-size: var(--font-xs);
    font-weight: 600;
    border-radius: 20px;
}

.post-card-title {
    font-size: var(--font-md);
    font-weight: 700;
    margin-bottom: 12px;
    line-height: var(--line-height-tight);
}

.post-card-title a {
    color: var(--text-primary);
    text-decoration: none;
}

.post-card-title a:hover {
    color: var(--primary-color);
}

.post-card-excerpt {
    font-size: var(--font-sm);
    color: var(--text-secondary);
    line-height: var(--line-height-normal);
    margin-bottom: 16px;
}

.post-card-meta {
    display: flex;
    gap: 16px;
    font-size: var(--font-xs);
    color: var(--text-tertiary);
}

.ad-banner-home {
    text-align: center;
    padding: 48px 24px;
    background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    border-radius: 16px;
    margin-top: 60px;
}

.ad-banner-home h3 {
    font-size: var(--font-xl);
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 12px;
}

.ad-banner-home p {
    font-size: var(--font-base);
    color: var(--text-secondary);
    margin-bottom: 24px;
}

.banner-button {
    padding: 12px 32px;
    background: white;
    color: var(--primary-color);
    font-size: var(--font-base);
    font-weight: 700;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.banner-button:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Fade-in Animation */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.home-hero {
    animation: fadeInUp 0.8s ease-out;
}

.category-card {
    animation: fadeInUp 0.8s ease-out;
    animation-fill-mode: both;
}

.category-card:nth-child(1) { animation-delay: 0.1s; }
.category-card:nth-child(2) { animation-delay: 0.2s; }
.category-card:nth-child(3) { animation-delay: 0.3s; }
.category-card:nth-child(4) { animation-delay: 0.4s; }

.post-card {
    animation: fadeInUp 0.8s ease-out;
    animation-fill-mode: both;
}

.post-card:nth-child(1) { animation-delay: 0.2s; }
.post-card:nth-child(2) { animation-delay: 0.3s; }
.post-card:nth-child(3) { animation-delay: 0.4s; }

@media (max-width: 768px) {
    .home-hero {
        padding: 40px 20px;
        margin-top: 2rem;
    }

    .hero-title {
        font-size: var(--font-xl);
    }

    /* 슬라이더 - 태블릿에서 3개씩 */
    .category-slider-wrapper {
        padding: 0 50px;
    }

    .category-card {
        width: calc((100% - 40px) / 3);
    }

    .slider-btn {
        width: 40px;
        height: 40px;
    }

    .category-image {
        height: 120px;
    }

    .category-content {
        padding: 16px;
    }

    .category-content h3 {
        font-size: var(--font-base);
        margin-bottom: 4px;
    }

    .category-content p {
        font-size: 0.75rem;
    }

    .post-list {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    /* 슬라이더 - 모바일에서 2개씩 */
    .category-slider-wrapper {
        padding: 0 40px;
    }

    .category-card {
        width: calc((100% - 20px) / 2);
    }

    .slider-btn {
        width: 36px;
        height: 36px;
    }

    .category-image {
        height: 100px;
    }

    .category-content {
        padding: 12px;
    }

    .indicator {
        width: 6px;
        height: 6px;
    }

    .indicator.active {
        width: 18px;
    }
}
</style>
{{ end }}
