#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
복구된 템플릿 파일 품질 개선 스크립트
318개 파일의 콘텐츠를 대폭 확장하여 SEO 최적화 및 사용자 가치 제공
"""

import os
import re
from pathlib import Path
from collections import defaultdict

# 카테고리별 상세 콘텐츠 템플릿
CONTENT_TEMPLATES = {
    'elementary': {
        'base_sections': [
            {
                'title': '왜 초등 시기가 중요한가?',
                'content': '''초등학교 시기는 **평생 학습의 기초**를 다지는 결정적 시기입니다.

### 초등 교육의 중요성
- **학습 습관 형성**: 올바른 공부 습관이 평생 학습 태도 결정
- **기초 학력**: 중·고등 학업 성취의 토대
- **자신감 구축**: 성공 경험이 학습 동기와 자존감 형성
- **사고력 발달**: 논리적·창의적 사고의 기반 마련'''
            },
            {
                'title': '학년별 맞춤 전략',
                'content': '''### 저학년 (1~3학년)
- **흥미 중심**: 재미있게 배우는 환경 조성
- **기초 다지기**: 읽기·쓰기·셈하기 집중
- **습관 형성**: 규칙적인 학습 시간 정착
- **자기주도성**: 스스로 하는 습관 길들이기

### 고학년 (4~6학년)
- **심화 학습**: 개념 이해와 응용력 강화
- **시간 관리**: 스스로 계획 세우고 실천하기
- **독서 확대**: 다양한 분야의 책 읽기
- **중등 준비**: 학습량 증가에 대비'''
            },
            {
                'title': '효과적인 학습 방법',
                'content': '''### 일일 학습 루틴
**30분 루틴** (저학년)
- 복습: 10분 (오늘 배운 내용)
- 숙제: 15분 (학교 과제)
- 예습: 5분 (내일 배울 내용 훑어보기)

**60분 루틴** (고학년)
- 복습: 20분 (오늘 배운 핵심 개념)
- 숙제: 25분 (학교 과제 + 문제집)
- 예습: 15분 (내일 수업 준비)

### 과목별 학습 팁
- **국어**: 매일 독서 30분 + 일기 쓰기
- **수학**: 개념 이해 후 충분한 연습
- **영어**: 파닉스 → 단어 → 문장 → 독해 단계적 학습
- **사회·과학**: 교과서 정독 + 용어 정리'''
            },
            {
                'title': '학부모가 해야 할 것',
                'content': '''### 환경 조성
- **전용 공간**: 조용하고 정돈된 학습 공간
- **규칙적 일과**: 일정한 시간에 공부하기
- **적절한 도구**: 학습에 필요한 준비물 구비
- **디지털 관리**: 스마트폰·게임 사용 규칙

### 동기 부여
- **작은 성취 인정**: 과정을 칭찬하기
- **목표 설정**: 달성 가능한 단기 목표
- **관심 표현**: 학교생활에 관심 갖기
- **롤모델 제시**: 긍정적인 본보기'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 초등학생 적정 학습 시간은?
A: 학년별로 다릅니다. **저학년은 30분~1시간**, **고학년은 1시간~2시간**이 적당합니다. 집중력을 고려해 10분 휴식을 포함하세요.

### Q2: 선행학습이 필요한가요?
A: **기초가 탄탄하면** 1-2학기 선행은 도움이 됩니다. 하지만 개념 이해 없이 진도만 나가면 오히려 역효과입니다.

### Q3: 사교육은 언제부터?
A: **학교 수업을 따라가기 어려울 때** 또는 **특정 과목 심화가 필요할 때** 시작하세요. 무조건 빠르게 시작할 필요는 없습니다.

### Q4: 학습 습관은 어떻게?
A: **규칙적인 시간**에 **짧게라도 매일** 하는 것이 핵심입니다. 처음엔 10분부터 시작해 점차 늘리세요.

### Q5: 게임·스마트폰 관리는?
A: **학습 후 보상**으로 제공하되, 시간 제한(하루 30분~1시간)을 두세요. 부모와 함께 규칙을 정하는 것이 효과적입니다.'''
            }
        ]
    },
    'middle': {
        'base_sections': [
            {
                'title': '왜 중학생 시기가 중요한가?',
                'content': '''중학교 시기는 **고등학교 진학과 대입의 기초**를 다지는 핵심 시기입니다.

### 중등 교육의 중요성
- **내신 관리**: 고교 선택과 대입에 영향
- **학습 방법**: 스스로 공부하는 방법 터득
- **진로 탐색**: 관심 분야와 적성 발견
- **자기관리**: 시간·감정 관리 능력 발달'''
            },
            {
                'title': '학년별 맞춤 전략',
                'content': '''### 중1: 중등 적응기
- **학습량 증가 대비**: 과목 수 증가, 난이도 상승
- **내신 시작**: 중간·기말고사 대비 시스템
- **기초 탄탄히**: 수학·영어 기본기 확립
- **학습 습관**: 자기주도 학습 루틴 정착

### 중2: 실력 도약기
- **심화 학습**: 개념 응용과 문제 해결력
- **진로 고민**: 관심 분야 탐색 시작
- **학습 방법**: 효율적 공부법 체득
- **균형 유지**: 학업·활동·휴식 조화

### 중3: 고등 준비기
- **내신 마무리**: 누적 내신 관리
- **고교 선택**: 학교·전형 정보 수집
- **실력 완성**: 고등 과정 대비 심화
- **입시 준비**: 자기소개서·면접 준비'''
            },
            {
                'title': '효과적인 학습 방법',
                'content': '''### 일일 학습 루틴
**평일 2-3시간**
- 복습: 30분 (오늘 수업 내용 정리)
- 숙제: 40분 (학교 과제)
- 문제집: 40분 (취약 과목 집중)
- 예습: 20분 (내일 수업 준비)
- 휴식: 10분 간격으로 배치

**주말 4-5시간**
- 주간 복습: 1시간
- 심화 학습: 2시간
- 오답 노트: 1시간
- 다음 주 예습: 1시간

### 과목별 전략
- **국어**: 독서(비문학) + 문학 + 문법 균형
- **수학**: 개념 → 유형 → 심화 → 응용 단계별
- **영어**: 단어 → 문법 → 독해 → 듣기 종합
- **사회·과학**: 교과서 정독 + 자료 해석
- **역사**: 흐름 파악 + 핵심 사건 암기'''
            },
            {
                'title': '내신 관리 전략',
                'content': '''### 시험 4주 전
- 전체 범위 파악
- 단원별 개념 정리
- 교과서·프린트 정독

### 시험 2주 전
- 문제집 1회독
- 오답 노트 정리
- 암기 사항 체크

### 시험 1주 전
- 문제집 2회독
- 취약 부분 집중
- 모의고사 풀이

### 시험 직전
- 핵심 요약 복습
- 실수 노트 확인
- 시험 시간표 점검'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 중학생 적정 학습 시간은?
A: **평일 2-3시간, 주말 4-5시간**이 적당합니다. 학원 시간을 포함하면 더 늘어날 수 있습니다.

### Q2: 내신 몇 등급이 좋은가요?
A: 특목고·자사고는 **1-2등급**, 일반고 상위권은 **2-3등급** 목표가 적절합니다.

### Q3: 선행학습은 어느 정도?
A: 수학·영어는 **1-2학기 선행**이 일반적입니다. 개념 이해를 우선하고, 과도한 선행은 피하세요.

### Q4: 학원은 몇 개가 적당?
A: **2-3개**가 적당합니다. 너무 많으면 자기주도 학습 시간이 부족해집니다.

### Q5: 슬럼프가 왔어요
A: **정상입니다**. 단기 목표를 세우고, 충분한 휴식을 취하세요. 필요시 상담을 받으세요.'''
            }
        ]
    },
    'high': {
        'base_sections': [
            {
                'title': '왜 고등학생 시기가 중요한가?',
                'content': '''고등학교 시기는 **대학 입시의 모든 것**이 결정되는 최종 관문입니다.

### 고등 교육의 중요성
- **대입 준비**: 내신·수능·비교과 종합 관리
- **진로 결정**: 학과·직업 구체화
- **학습 완성**: 최고 수준의 학업 역량
- **자립 준비**: 성인으로서의 책임과 선택'''
            },
            {
                'title': '학년별 맞춤 전략',
                'content': '''### 고1: 입시 기초기
- **내신 시작**: 1학기부터 전력 투구
- **학습 방법**: 고등 학습량에 적응
- **진로 탐색**: 관심 학과·직업 구체화
- **비교과**: 독서·활동·봉사 시작

### 고2: 실력 심화기
- **내신 집중**: 학년별 내신 20% 반영
- **수능 기초**: 국·영·수 기본기 완성
- **세특 관리**: 교과 세특 전략적 준비
- **활동 심화**: 진로 연계 활동 강화

### 고3: 입시 완성기
- **수능 완성**: 6월·9월 모평 목표 달성
- **정시 대비**: 수능 최저 확보+상향
- **수시 준비**: 생기부·자소서·면접
- **최종 선택**: 전략적 지원 대학 결정'''
            },
            {
                'title': '효과적인 학습 방법',
                'content': '''### 일일 학습 루틴
**평일 4-6시간** (학원 제외)
- 자습 1교시: 1.5시간 (오늘 복습)
- 자습 2교시: 1.5시간 (문제 풀이)
- 자습 3교시: 1.5시간 (취약 과목)
- 자습 4교시: 1.5시간 (내일 예습)

**주말 8-10시간**
- 주간 복습: 2시간
- 심화 문제: 3시간
- 오답 노트: 2시간
- 약점 보완: 2시간
- 다음 주 예습: 1시간

### 수능 과목별 전략
- **국어**: 독서(비문학) 집중 + 문학 작품 정리
- **수학**: 개념→기출→심화 반복
- **영어**: 어휘 확장 + 독해 속도 향상
- **탐구**: 개념 완성 + 자료 해석 연습
- **제2외국어/한문**: 단기 집중 암기'''
            },
            {
                'title': '수시 vs 정시 전략',
                'content': '''### 수시 전형
**학생부 종합 (학종)**
- 대상: 내신 1-3등급 + 풍부한 비교과
- 준비: 세특·독서·활동 일관성
- 장점: 수능 최저만 맞추면 합격 가능
- 단점: 비교과 준비 시간 필요

**학생부 교과**
- 대상: 내신 1-2등급
- 준비: 내신 집중 관리
- 장점: 단순 명확한 평가
- 단점: 내신 경쟁 치열

**논술**
- 대상: 내신 2-4등급 + 논술 실력
- 준비: 논술 학원 + 기출 분석
- 장점: 내신 만회 기회
- 단점: 경쟁률 매우 높음

### 정시 전형
- 대상: 수능 성적 우수자
- 준비: 수능 집중 학습
- 장점: 명확한 점수 기준
- 단점: 한 번의 시험으로 결정'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 고등학생 적정 학습 시간은?
A: **평일 4-6시간, 주말 8-10시간** (학원 시간 제외)입니다. 고3은 더 늘어날 수 있습니다.

### Q2: 수시와 정시 비율은?
A: 일반적으로 **수시 6개 + 정시 준비**를 병행합니다. 자신의 강점에 따라 조절하세요.

### Q3: 내신과 수능 중 뭐가 중요?
A: **둘 다 중요**합니다. 수시는 내신, 정시는 수능이 핵심이므로 **병행 준비**가 필수입니다.

### Q4: 학원은 몇 개?
A: **2-4개**가 일반적입니다. 국·영·수 + 탐구 또는 논술을 선택적으로 다닙니다.

### Q5: 슬럼프 극복 방법은?
A: **단기 목표** 설정, **충분한 휴식**, **상담** 활용이 효과적입니다. 완벽을 추구하지 말고 **꾸준함**을 유지하세요.'''
            }
        ]
    },
    'consultation': {
        'base_sections': [
            {
                'title': '왜 학습 상담이 필요한가?',
                'content': '''학습 상담은 **최적의 학습 방향**을 찾고 **효율적인 계획**을 세우는 데 필수적입니다.

### 상담의 효과
- **방향 설정**: 명확한 목표와 로드맵
- **맞춤 전략**: 개인 특성에 맞는 방법
- **문제 해결**: 학습 장애 요인 제거
- **동기 부여**: 지속적인 학습 의지'''
            },
            {
                'title': '상담 유형별 특징',
                'content': '''### 학습 상담
- **목적**: 공부 방법 개선
- **내용**: 학습 습관, 시간 관리, 과목별 전략
- **대상**: 성적 향상을 원하는 모든 학생
- **효과**: 학업 효율성 증대

### 진로 상담
- **목적**: 적성과 진로 발견
- **내용**: 흥미·적성 검사, 직업 탐색
- **대상**: 진로 고민이 있는 학생
- **효과**: 명확한 방향성 확립

### 진학 상담
- **목적**: 상급 학교 선택
- **내용**: 입시 전략, 학교 정보
- **대상**: 진학을 앞둔 학생
- **효과**: 전략적 진학 계획

### 심리 상담
- **목적**: 정서적 안정
- **내용**: 스트레스 관리, 불안 해소
- **대상**: 심리적 어려움이 있는 학생
- **효과**: 학습 집중력 향상'''
            },
            {
                'title': '효과적인 상담 활용법',
                'content': '''### 상담 전 준비
1. **고민 정리**: 무엇이 문제인지 구체화
2. **자료 준비**: 성적표, 생활기록부 등
3. **목표 설정**: 상담을 통해 얻고 싶은 것
4. **질문 작성**: 궁금한 사항 리스트

### 상담 중 태도
- **솔직하게**: 있는 그대로 이야기
- **적극적으로**: 궁금한 것 질문
- **메모하기**: 중요한 내용 기록
- **경청하기**: 전문가 조언 집중

### 상담 후 실천
- **계획 수립**: 구체적 실행 방안
- **즉시 시작**: 바로 실천하기
- **점검하기**: 정기적 진행 확인
- **추가 상담**: 필요시 재상담'''
            },
            {
                'title': '학년별 상담 포인트',
                'content': '''### 초등학생
- 학습 습관 형성
- 흥미와 적성 발견
- 기초 학력 점검
- 부모 상담 병행

### 중학생
- 내신 관리 전략
- 진로 탐색 시작
- 학습 방법 개선
- 고교 선택 준비

### 고등학생
- 입시 전략 수립
- 학과·대학 선택
- 비교과 관리
- 수시·정시 준비'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 상담은 언제 받나요?
A: **문제가 생기기 전** 정기적으로 받는 것이 좋습니다. 학기 초, 시험 후, 진급 전이 적기입니다.

### Q2: 상담 효과는?
A: 대부분 **3-6개월** 내 변화를 느낍니다. 즉각적 효과보다는 **장기적 성장**을 목표로 하세요.

### Q3: 부모도 상담 받나요?
A: **네, 필요합니다**. 부모 상담을 통해 가정에서의 지원 방법을 배울 수 있습니다.

### Q4: 비용은?
A: 1회 상담 기준으로 다양합니다. 학교 상담은 무료, 전문 상담은 유료입니다.

### Q5: 온라인 상담도 되나요?
A: **가능합니다**. 화상 상담으로 시간과 장소 제약 없이 받을 수 있습니다.'''
            }
        ]
    },
    'tutoring': {
        'base_sections': [
            {
                'title': '왜 1:1 과외가 효과적인가?',
                'content': '''1:1 과외는 **개인 맞춤형 교육**으로 가장 효율적인 학습 방법입니다.

### 1:1 과외의 장점
- **맞춤형 수업**: 학생 수준에 정확히 맞춤
- **집중 관리**: 한 명만 집중 지도
- **유연한 스케줄**: 시간·장소 조정 가능
- **즉각적 피드백**: 실시간 질문·답변'''
            },
            {
                'title': '좋은 과외 선생님 선택법',
                'content': '''### 확인해야 할 사항
**학력·경력**
- 전공 및 학력 (대학·대학원)
- 과외 경력 (년수·학생 수)
- 지도 과목 전문성
- 합격 실적 (있는 경우)

**교수 방법**
- 수업 방식 (이론·문제·토론)
- 교재 선택 기준
- 진도 관리 방법
- 피드백 시스템

**인성·태도**
- 책임감과 성실성
- 소통 능력
- 학생 이해도
- 학부모 응대

### 첫 상담 시 질문 리스트
1. "지도 경력은 얼마나 되시나요?"
2. "어떤 교재를 사용하시나요?"
3. "수업은 어떻게 진행하시나요?"
4. "숙제와 피드백은?"
5. "학부모 소통은 어떻게?"'''
            },
            {
                'title': '과외 효과 극대화 방법',
                'content': '''### 수업 전 준비
- **예습하기**: 다음 수업 내용 미리 보기
- **질문 정리**: 모르는 것 메모
- **교재 준비**: 필요한 자료 챙기기
- **컨디션 관리**: 충분한 휴식

### 수업 중 태도
- **집중하기**: 스마트폰 끄기
- **필기하기**: 중요한 내용 기록
- **질문하기**: 이해 안 되면 바로 질문
- **피드백 수용**: 선생님 조언 경청

### 수업 후 복습
- **당일 복습**: 수업 내용 정리 (30분)
- **숙제하기**: 성실히 완수
- **오답 정리**: 틀린 문제 다시 풀기
- **다음 준비**: 다음 수업 예습

### 정기 점검
- **월간 평가**: 한 달 진도 점검
- **성적 확인**: 시험 결과 분석
- **목표 조정**: 필요시 계획 수정
- **상담하기**: 선생님과 정기 대화'''
            },
            {
                'title': '과외 유형별 특징',
                'content': '''### 방문 과외
- **장점**: 집중도 높음, 교통 편리
- **단점**: 비용 높음, 공간 필요
- **적합**: 집 환경이 좋은 경우

### 선생님 댁 과외
- **장점**: 비용 저렴, 학습 분위기
- **단점**: 이동 시간, 날씨 영향
- **적합**: 근거리 거주 시

### 온라인 과외
- **장점**: 시간 절약, 녹화 복습
- **단점**: 집중도 낮을 수 있음
- **적합**: 지방 거주, 시간 부족

### 그룹 과외
- **장점**: 비용 절감, 경쟁 동기
- **단점**: 맞춤 지도 어려움
- **적합**: 비슷한 수준 학생들'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 과외 비용은?
A: 선생님 학력·경력에 따라 다릅니다. **대학생 5-8만원/시간**, **대학원생·전문 강사 10-15만원/시간**이 일반적입니다.

### Q2: 주 몇 회가 적당?
A: **주 2-3회**가 일반적입니다. 과목 난이도와 학생 수준에 따라 조절하세요.

### Q3: 한 번에 몇 시간?
A: **1.5-2시간**이 적당합니다. 너무 길면 집중력이 떨어집니다.

### Q4: 학원과 병행 가능?
A: **가능합니다**. 학원에서 진도, 과외에서 심화 또는 보충 형태로 활용하면 효과적입니다.

### Q5: 언제 선생님을 바꾸나요?
A: **3개월 후에도 성적 변화가 없거나** **소통이 안 되면** 교체를 고려하세요. 너무 자주 바꾸는 것은 비추천합니다.'''
            }
        ]
    },
    'exam': {
        'base_sections': [
            {
                'title': '왜 시험 대비가 중요한가?',
                'content': '''체계적인 시험 대비는 **최고의 성적**을 위한 필수 과정입니다.

### 시험의 중요성
- **학업 성취도**: 학습 수준 객관적 평가
- **상급 학교 진학**: 내신·수능이 당락 결정
- **자신감 형성**: 좋은 결과가 학습 동기 부여
- **시간 관리**: 계획적 학습 습관 형성'''
            },
            {
                'title': '시험 유형별 대비 전략',
                'content': '''### 중간·기말고사 (내신)
**특징**
- 학교 수업 범위 내 출제
- 교과서·프린트·문제집 중심
- 학교별 출제 경향 존재

**대비 전략**
- 수업 집중 + 필기 완벽
- 교과서 정독 (3회 이상)
- 학교 프린트 반복 (5회)
- 기출문제 분석
- 오답 노트 정리

### 모의고사 (수능 대비)
**특징**
- 전국 단위 평가
- 수능과 동일한 유형
- 상대 평가 (등급제)

**대비 전략**
- 기출 문제 (3개년)
- 시간 안배 연습
- 약점 과목 집중
- 오답 분석 철저
- 실전 모의고사

### 수능
**특징**
- 대입 당락 결정
- 한 번의 기회
- 절대적 집중력 필요

**대비 전략**
- 기출 완벽 분석 (10개년)
- EBS 연계 학습
- 실전 감각 유지
- 멘탈 관리
- 컨디션 조절'''
            },
            {
                'title': '효과적인 시험 공부법',
                'content': '''### 4주 전 (기초 다지기)
**목표**: 전체 범위 개념 이해
- 교과서 정독 (1회독)
- 핵심 개념 정리
- 용어·공식 암기
- 진도별 문제 풀이

**일일 학습량**
- 평일: 2-3시간
- 주말: 4-5시간

### 2주 전 (실력 다지기)
**목표**: 문제 풀이 능력 향상
- 문제집 1회독
- 오답 노트 작성
- 취약 부분 집중
- 암기 사항 반복

**일일 학습량**
- 평일: 3-4시간
- 주말: 6-7시간

### 1주 전 (마무리)
**목표**: 완성도 높이기
- 문제집 2회독
- 오답 재풀이
- 모의고사 풀이
- 실수 노트 정리

**일일 학습량**
- 평일: 4-5시간
- 주말: 8-10시간

### 시험 전날
**목표**: 컨디션 유지
- 핵심 요약 복습 (2시간)
- 오답 노트 확인 (1시간)
- 시험 준비물 점검
- 일찍 자기 (11시 전)'''
            },
            {
                'title': '시험 당일 전략',
                'content': '''### 시험 전
- **아침 식사**: 가볍게 먹기
- **준비물**: 2-3번 확인
- **일찍 도착**: 30분 전
- **심호흡**: 긴장 풀기

### 시험 중
**문제 풀이 순서**
1. 전체 훑어보기 (1분)
2. 쉬운 문제부터 (60%)
3. 중간 난이도 (30%)
4. 어려운 문제 (10%)

**시간 관리**
- 과목당 시간 배분
- 어려운 문제 과감히 패스
- 마지막 10분 검토 시간

**실수 방지**
- 문제 끝까지 읽기
- 답안지 확인 (2번)
- 계산 검산
- OMR 마킹 확인

### 시험 후
- **휴식**: 충분한 휴식
- **채점**: 바로 채점하지 말기
- **오답 분석**: 나중에 차분히
- **다음 준비**: 다음 시험 대비'''
            },
            {
                'title': '자주 묻는 질문 (FAQ)',
                'content': '''### Q1: 시험 공부는 언제부터?
A: 최소 **4주 전**부터 시작하세요. 주요 과목은 더 일찍 준비하면 좋습니다.

### Q2: 벼락치기 효과 있나요?
A: **단기 기억**에는 도움이 되지만, **장기 학습**에는 비효율적입니다. 꾸준한 공부가 최선입니다.

### Q3: 오답 노트 꼭 필요?
A: **매우 중요합니다**. 틀린 문제를 다시 틀리지 않는 것이 성적 향상의 핵심입니다.

### Q4: 시험 불안은 어떻게?
A: **충분한 준비**, **심호흡**, **긍정적 사고**가 도움됩니다. 너무 완벽을 추구하지 마세요.

### Q5: 시험 망쳤어요
A: **다음 시험을 준비**하세요. 오답 분석으로 약점을 보완하고, **포기하지 마세요**.'''
            }
        ]
    }
}

def read_file(file_path):
    """파일 읽기"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except Exception as e:
        print(f"  ❌ 읽기 실패 ({file_path.name}): {e}")
        return None

def parse_front_matter(content):
    """Front Matter 파싱"""
    parts = content.split('---', 2)
    if len(parts) < 3:
        return None, content

    front_matter = parts[1].strip()
    body = parts[2].strip()

    return front_matter, body

def get_category_from_path(file_path):
    """파일 경로에서 카테고리 추출"""
    parts = file_path.parts
    if len(parts) >= 2:
        category = parts[-2]  # content/카테고리/파일명.md

        # 카테고리 매핑
        category_map = {
            'elementary': 'elementary',
            'middle': 'middle',
            'high': 'high',
            'consultation': 'consultation',
            'tutoring': 'tutoring',
            'exam': 'exam'
        }

        return category_map.get(category, 'elementary')

    return 'elementary'

def enhance_content(file_path):
    """콘텐츠 품질 개선"""
    content = read_file(file_path)
    if not content:
        return False

    front_matter, body = parse_front_matter(content)
    if not front_matter:
        return False

    # 이미 충분한 콘텐츠가 있으면 스킵 (200줄 이상)
    if len(body.split('\n')) > 200:
        return False

    # 카테고리 파악
    category = get_category_from_path(file_path)

    # 해당 카테고리의 템플릿 가져오기
    if category not in CONTENT_TEMPLATES:
        return False

    template = CONTENT_TEMPLATES[category]

    # 기존 제목과 CTA는 유지하고, 사이에 상세 콘텐츠 삽입
    # 기존 body에서 첫 번째 제목과 CTA 사이에 내용 추가

    # 새로운 body 구성
    new_sections = []

    # 기본 섹션들 추가
    for section in template['base_sections']:
        new_sections.append(f"\n## {section['title']}\n")
        new_sections.append(section['content'])

    # 마무리 섹션
    new_sections.append('''

## 마무리

체계적인 준비와 꾸준한 노력으로 목표를 달성하세요.
성공은 하루아침에 오지 않지만, 올바른 방향으로 꾸준히 나아가면 반드시 이루어집니다.

오늘부터 시작하세요!

{{< cta-consultation-final >}}

---

*본 글은 일반적인 교육 가이드이며, 개별 학생의 상황에 맞춰 적절히 조절하여 적용하시기 바랍니다.*
''')

    # 기존 front matter + 향상된 body
    enhanced_content = f"---\n{front_matter}\n---\n" + '\n'.join(new_sections)

    # 파일 저장
    try:
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(enhanced_content)
        return True
    except Exception as e:
        print(f"  ❌ 쓰기 실패: {e}")
        return False

def main():
    """메인 실행 함수"""
    content_dir = Path('content')

    # 복구된 파일 패턴들
    restored_patterns = [
        'elem-b9-*.md',
        'elementary-final-*.md',
        'mid-b9-*.md',
        'middle-final-*.md',
        'high-b9-*.md',
        'high-final-*.md',
        'consultation-guide-*.md',
        'exam-preparation-*.md',
        'tutoring-guide-*.md',
        'tutoring-advanced-*.md'
    ]

    enhanced_count = 0
    skipped_count = 0
    failed_count = 0

    print("🔄 복구된 파일 품질 개선 시작...\n")

    # 각 카테고리별로 처리
    categories = ['elementary', 'middle', 'high', 'consultation', 'exam', 'tutoring']

    for category in categories:
        category_dir = content_dir / category
        if not category_dir.exists():
            continue

        md_files = list(category_dir.glob('*.md'))

        print(f"\n📁 {category.upper()} ({len(md_files)}개 파일)")
        print("-" * 60)

        for md_file in md_files:
            # 파일명 패턴 확인 (복구된 파일만 처리)
            is_restored = any(md_file.match(pattern) for pattern in restored_patterns)

            if not is_restored:
                continue

            print(f"처리 중: {md_file.name}")

            if enhance_content(md_file):
                enhanced_count += 1
                print(f"  ✅ 개선 완료")
            else:
                # 이미 충분한 콘텐츠가 있거나 실패
                content = read_file(md_file)
                if content and len(content.split('\n')) > 200:
                    skipped_count += 1
                    print(f"  ⏭️  스킵 (이미 충분한 콘텐츠)")
                else:
                    failed_count += 1
                    print(f"  ❌ 실패")

    print(f"\n{'='*60}")
    print(f"✅ 콘텐츠 개선 완료!")
    print(f"{'='*60}")
    print(f"개선 완료: {enhanced_count}개")
    print(f"스킵: {skipped_count}개")
    print(f"실패: {failed_count}개")
    print(f"총: {enhanced_count + skipped_count + failed_count}개")
    print(f"{'='*60}")

if __name__ == '__main__':
    main()
