[
  {
    "key": "/js/viral.js",
    "value": "// 사용자 카운터 초기화 및 애니메이션\n// 서버(Worker)에서 KV에 저장된 실제 방문자 수를 HTML에 주입함\n// 이 함수는 서버에서 주입된 값을 읽어서 애니메이션만 적용\nfunction initUsageCounter() {\n    const countElement = document.getElementById('usageCount');\n    if (!countElement) return;\n\n    // 서버에서 주입한 값 읽기 (Worker가 KV 카운터 값을 HTML에 주입)\n    const serverCount = parseInt(countElement.textContent.replace(/,/g, '')) || 0;\n\n    // 서버 값이 유효하면 (0보다 크면) 서버 값 사용, 아니면 기본값\n    const currentCount = serverCount > 0 ? serverCount : 1000;\n\n    // 애니메이션 효과 (카운트업)\n    let displayCount = Math.max(0, currentCount - 100);\n    const increment = Math.ceil(100 / 30);\n\n    const timer = setInterval(() => {\n        displayCount += increment;\n        if (displayCount >= currentCount) {\n            displayCount = currentCount;\n            clearInterval(timer);\n        }\n        countElement.textContent = displayCount.toLocaleString();\n    }, 30);\n}\n\n// 페이스북 공유\nfunction shareFacebook() {\n    const url = encodeURIComponent(window.location.href);\n    const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;\n    window.open(shareUrl, '_blank', 'width=600,height=400');\n}\n\n// 트위터 공유\nfunction shareTwitter() {\n    const url = encodeURIComponent(window.location.href);\n    const text = encodeURIComponent(document.title);\n    const shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;\n    window.open(shareUrl, '_blank', 'width=600,height=400');\n}\n\n// 링크 복사\nfunction copyLink() {\n    const url = window.location.href;\n    const btn = document.getElementById('copyBtn');\n    if (!btn) return;\n\n    if (navigator.clipboard && navigator.clipboard.writeText) {\n        navigator.clipboard.writeText(url).then(() => {\n            const originalHTML = btn.innerHTML;\n            btn.innerHTML = '<span>✅</span> 복사 완료!';\n            btn.style.background = '#10b981';\n            btn.style.color = 'white';\n\n            setTimeout(() => {\n                btn.innerHTML = originalHTML;\n                btn.style.background = 'white';\n                btn.style.color = '#667eea';\n            }, 2000);\n        }).catch(err => {\n            alert('링크 복사에 실패했습니다.');\n        });\n    } else {\n        const textarea = document.createElement('textarea');\n        textarea.value = url;\n        textarea.style.position = 'fixed';\n        textarea.style.opacity = '0';\n        document.body.appendChild(textarea);\n        textarea.select();\n\n        try {\n            document.execCommand('copy');\n            const originalHTML = btn.innerHTML;\n            btn.innerHTML = '<span>✅</span> 복사 완료!';\n            btn.style.background = '#10b981';\n            btn.style.color = 'white';\n\n            setTimeout(() => {\n                btn.innerHTML = originalHTML;\n                btn.style.background = 'white';\n                btn.style.color = '#667eea';\n            }, 2000);\n        } catch (err) {\n            alert('링크 복사에 실패했습니다.');\n        }\n\n        document.body.removeChild(textarea);\n    }\n}\n\n// 북마크 팝업 표시\nfunction showBookmarkPopup() {\n    const visitKey = 'eduguide_visit_count';\n    const popupDismissedKey = 'eduguide_bookmark_dismissed';\n\n    if (localStorage.getItem(popupDismissedKey)) {\n        return;\n    }\n\n    let visitCount = parseInt(localStorage.getItem(visitKey)) || 0;\n    visitCount++;\n    localStorage.setItem(visitKey, visitCount);\n\n    if (visitCount === 3) {\n        const popup = document.getElementById('bookmarkPopup');\n        if (popup) {\n            popup.style.display = 'block';\n        }\n    }\n}\n\nfunction closeBookmarkPopup(addBookmark) {\n    const popup = document.getElementById('bookmarkPopup');\n    if (popup) {\n        popup.style.display = 'none';\n    }\n    localStorage.setItem('eduguide_bookmark_dismissed', 'true');\n\n    if (addBookmark) {\n        alert('Ctrl+D (Windows) 또는 Cmd+D (Mac)를 눌러 북마크에 추가하세요!');\n    }\n}\n\n// 서비스 워커 등록\nif ('serviceWorker' in navigator) {\n    navigator.serviceWorker.register('/sw.js')\n        .then(registration => console.log('SW registered'))\n        .catch(err => console.log('SW registration failed'));\n}\n\n// 페이지 로드 시 초기화\nwindow.addEventListener('load', () => {\n    initUsageCounter();\n    showBookmarkPopup();\n});\n"
  }
]